const jwt=require("jsonwebtoken"),checkAuth=e=>(t,o,s)=>{const n=t.headers.authorization.split(" ")[1];if(!n)return o.status(401).json({message:"No Token, Authentication failed!"});try{const o=jwt.verify(n,e);t.user=o,s()}catch(e){console.log("checkAuth error",e),o.status(401).json({message:"checkAuth Unauthorized: token invalid"})}};module.exports=checkAuth;